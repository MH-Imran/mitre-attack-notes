# T1047 — Windows Management Instrumentation (WMI)


## What is WMI

WMI is a built-in Windows feature that lets you interact with almost anything on the system — hardware details, software info, running processes, services, registry entries, network settings, and more. Administrators use it all the time for automation and remote management.

The part that matters for cybersecurity is this:  
because WMI is such a powerful “admin tool,” attackers can use it the same way. They can run commands, gather system info, or even execute things on another machine without needing to install anything new. Since WMI is native to Windows, this activity often blends in with normal admin work and doesn’t immediately look suspicious.

In short: **WMI is legitimate, powerful, and easy for attackers to hide inside.**

## Common Attack Uses

Attackers often rely on WMI for:

- **Running commands or programs remotely** using `wmic.exe` or WMI scripts  
- **Collecting system information** such as OS details, users, registry keys, or network configuration  
- **Moving laterally** inside a network by using WMI to execute commands on another computer  
- **Persistence**, such as creating services or tasks that automatically run during startup or at scheduled times  

WMI gives attackers a quiet, flexible way to continue their activities once they have access.

## Why WMI is Useful (for attackers and defenders)

- It’s already installed on every Windows machine — no extra tools needed  
- It works both **locally and remotely**, which is perfect for lateral movement  
- It exposes lots of system internals, letting an attacker gather detailed information  
- If the attacker already has valid credentials, WMI lets them operate with very little noise  

For defenders, this means we have to pay close attention to **how** WMI is being used rather than simply whether it’s being used.

## Detection & Logging Considerations

Catching malicious WMI activity requires the right logs and some awareness of what “normal” WMI use looks like.

Things to monitor:

- WMI launching unusual processes like `powershell.exe`, `cmd.exe`, or unknown scripts  
- WMI-Activity logs in Windows Event Viewer showing remote calls or suspicious queries  
- Unexpected remote executions, especially between machines that don’t normally talk  
- Account behavior — WMI being used by accounts that usually don’t run administrative commands  
- Network traffic on ports **135** (DCOM) and **5985/5986** (WinRM) when remote WMI is involved  
- Service creation or registry changes triggered through WMI  

Tools like Sysmon, Wazuh, or any SIEM platform make detection much easier when WMI logging is properly enabled.

## My Notes / Personal Observations

- WMI feels harmless at first, but once you see how much it can do, you realize why attackers love it.  
- On older Windows versions, `wmic.exe` is a common entry point. On newer systems, attackers may lean more toward PowerShell WMI functions.  
- When analyzing alerts, looking at the **parent process**, **user account**, and **execution context** reveals a lot about whether WMI is being misused.  
- Practicing WMI activity inside a safe lab is extremely helpful — seeing the logs and process trees makes everything much easier to understand later.

